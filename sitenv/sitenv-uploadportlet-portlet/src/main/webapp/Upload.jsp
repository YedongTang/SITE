      <%@ taglib uri="http://java.sun.com/portlet_2_0" prefix="portlet"%>      <%@ taglib uri="http://liferay.com/tld/aui" prefix="aui"%>      <%@ taglib uri="http://liferay.com/tld/ui" prefix="liferay-ui"%>      <%@ page import="com.liferay.portal.kernel.util.ParamUtil"%>      <%@ page import="com.liferay.portal.kernel.util.Validator"%>      <%@ page import="com.liferay.portlet.PortletPreferencesFactoryUtil" %>      <%@ page import="javax.portlet.PortletPreferences"%>      <%@ page import="com.liferay.util.PwdGenerator"%>      <%@ page import="com.liferay.portal.service.PortletPreferencesLocalServiceUtil" %>      <%@ page import="com.liferay.portal.kernel.util.WebKeys" %>            <portlet:defineObjects />      <%      	  String uploadProgressId = PwdGenerator.getPassword(PwdGenerator.KEY3, 4);          PortletPreferences prefs = renderRequest.getPreferences();                    String portletResource = ParamUtil.getString(request, "portletResource");          prefs = PortletPreferencesFactoryUtil.getPortletSetup(request, portletResource);                    /*          String portletName = Portletconfig.getPortletName();          Portlet portlet = PortletLocalServiceUtil.getPortletById(portletName);          long companyId = portlet.getCompanyId();          PortletPreferences defaultPreferencesMap = PortletPreferencesLocalServiceUtil.getDefaultPreferences(companyId, portletName);          */                    String portletInstanceId = (String) renderRequest.getAttribute(WebKeys.PORTLET_ID);          prefs = PortletPreferencesFactoryUtil.getPortletSetup(request, portletInstanceId);                	  String javaScriptNamespace = prefs.getValue("JsNs", null);      	        	  String serviceContext =       			 	request.getScheme() + "://" + request.getServerName() +  				  	":" + request.getServerPort() + "/delegate";      	        	  //String ccdaloadserviceUrl = serviceContext + prefs.getValue("CcdaUploadServiceUrl", null);      	  String ccdaloadserviceUrl = prefs.getValue("CcdaUploadServiceUrl", null);      	        	  //String resultsaveasserviceUrl = serviceContext + prefs.getValue("ResultSaveAsServiceUrl", null);      	  String resultsaveasserviceUrl = prefs.getValue("ResultSaveAsServiceUrl", null);      	   		  //String smartccdaservicerelayUrl = serviceContext + prefs.getValue("SmartCCDAServiceUrl", null);		  String smartccdaservicerelayUrl = prefs.getValue("SmartCCDAServiceUrl", null);		  		 String smartccdaremoteserviceUrl = prefs.getValue("SmartCCDARemoteServiceUrl", null);		 		 String smartccdaremoterubricUrl = prefs.getValue("SmartCCDARemoteRubricsUrl", null);		        %>                      <portlet:actionURL var="editCaseURL" name="uploadFile">          <portlet:param name="jspPage" value="/Upload.jsp" />      </portlet:actionURL>            <liferay-ui:success key="success" message="CCD upload completed!" />            <liferay-ui:error key="error" message="CCD contains error(s)." />            <liferay-ui:upload-progress id="<%= uploadProgressId %>" message="uploading" redirect="<%= editCaseURL %>"/>            <portlet:resourceURL var="ajaxResourceUrl"/>            <script type="text/javascript">		      	window.currentContextPath = "<%=request.getContextPath()%>";      		function <%= javaScriptNamespace %>_callAjax()		{		    var url = "<%= ccdaloadserviceUrl %>";					    //Make ajax call 		    $.ajax({		    type : "GET",		    url : url,		    cache:false,		    dataType: "text",		    success : function(data) 		    {		     	alert(data);		    },		    error : function(XMLHttpRequest, textStatus, errorThrown) 		    {		      	alert("error");				    }		  });		};			</script>                  <!--       <aui:form action="<%= editCaseURL %>" enctype="multipart/form-data" method="post" >      	<aui:input type="file" name="fileName" size="75"/>      	<input type="submit" value="<liferay-ui:message key="upload" />"       			onClick="<%= uploadProgressId %>.startProgress(); return true;"/>      </aui:form>       -->       	<!-- method="POST" action="<%= editCaseURL %>" -->      	<form id="CCDAValidationForm" enctype="multipart/form-data" relay="<%=smartccdaservicerelayUrl %>" action="<%= ccdaloadserviceUrl %>">      		<h3><b>Please select one of the document type below. (validation may take up to one minute to run)</b></h3>      		<ol id="ccda_type_radioboxgroup">			  <li value = "ClinicalOfficeVisitSummary" class="ui-widget-content">Clinical Office Visit Summary - MU2 170.314(e)(2) - Clinical Summary</li>			  <li value="TransitionsOfCareAmbulatorySummary" class="ui-widget-content">Transitions Of Care Ambulatory Summary - MU2 170.314(b)(2) Transition of Care/Referral Summary - For Ambulatory Care</li>			  <li value="TransitionsOfCareAmbulatorySummary" class="ui-widget-content">Transitions Of Care Ambulatory Summary - MU2 170.314(b)(7) Data Portability - For Ambulatory Care</li>			  <li value="TransitionsOfCareAmbulatorySummary" class="ui-widget-content">Transitions Of Care Ambulatory Summary - MU2 170.314(b)(1) Transition of Care Receive - For Ambulatory Care</li>			  <li value="TransitionsOfCareInpatientSummary" class="ui-widget-content">Transitions Of Care Inpatient Summary - MU2 170.314(b)(2) Transition of Care/Referral Summary - For Inpatient Care</li>			  <li value="TransitionsOfCareInpatientSummary" class="ui-widget-content">Transitions Of Care Inpatient Summary - MU2 170.314(b)(7) Data Portability - For Inpatient Care</li>			  <li value="TransitionsOfCareInpatientSummary" class="ui-widget-content">Transitions Of Care Inpatient Summary - MU2 170.314(b)(1) Transition of Care Receive - For Inpatient Care</li>			  <li value="VDTAmbulatorySummary" class="ui-widget-content">VDT Ambulatory Summary - MU2 170.314 (e)(1) Ambulatory Summary</li>			  <li value="VDTInpatientSummary" class="ui-widget-content">VDT Inpatient Summary - MU2 170.314 (e)(1) Inpatient Summary</li>			  <li value="ClinicalOfficeVisitSummary" class="ui-widget-content">Non-specific CCDA</li>			</ol>			<input type="hidden" name="ccda_type_val" value="">			<input type="hidden" name="smart_ccda_url" value="<%=smartccdaremoteserviceUrl %>">			<input type="hidden" name="smart_ccda_rubrics_url" value="<%=smartccdaremoterubricUrl %>">						<!-- <input type="file" name="upload_ccda" id="ccdafileChooser" onChange="fileSelected()" /> -->			<hr/>			<div class="fileinputs">				<input type="file" name="upload_ccda" id="ccdafileChooser" onChange="fileSelected()" class="file" />				<div class="fakefile">					<input />					<img />				</div>			</div>						<button id="ccdavalidate_btn" >Validate Document</button>      	</form>      	      	<form id="downloadtest" action="<%= resultsaveasserviceUrl %>" style="display:none; cursor: default">      		<textarea cols="40" rows="5" name="reportContent">				Now we are inside the area - which is nice.			</textarea>			<input type="submit" value="Send me your name!"><br>			<input name="portletContextPath" type="hidden" value="<%=request.getContextPath()%>" />      	</form>      	      	<div id="ValidationResult" style="display:none">      		<div id="tabs">			  <ul>			    <li><a href="#tabs-1">Validation Result</a></li>			    <li><a href="#tabs-2">Original CCDA</a></li>			    <li><a href="#tabs-3">Smart CCDA Result</a></li>			  </ul>			  <div id="tabs-1">			    <h2>Content heading 1</h2>			  </div>			  <div id="tabs-2">			    <h2>Place holder</h2>			    <p>Under construction.</p>			  </div>			  <div id="tabs-3">			  </div>			</div>      	</div>      	      	<div id="reportSaveAsQuestion" style="display:none; cursor: default"> 	    	<fieldset>				<legend><b>Save your report as:</b></legend>					<div>					<div class="radio">					<input type="radio" id="single" name="marital_status" checked value="single" style="border:3px solid green">					</div>					<label for="single">PDF</label>				</div>								<div>					<div class="radio">					<input type="radio" id="married" name="marital_status" value="married" disabled>					</div>					<label for="married">HTML</label>				</div>								<div>					<div class="radio">					<input type="radio" id="married" name="marital_status" value="married" disabled>					</div>					<label for="married">TXT</label>				</div>				</fieldset>	        <button id="yes">OK</button> 	        <button id="no">Cancel</button>       	</div>      	      	      <portlet:renderURL var="viewCaseURL">          <portlet:param name="jspPage" value="/view2.jsp" />      </portlet:renderURL>            